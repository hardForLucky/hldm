function lunboTemplate(){$.getJSON("http://czdm.ittun.com/api/getlunbo",null,function(t){var e=template("lunbo",{items:t});$(".hp_banner ul").html(e),pictureLoop()})}function pictureLoop(){var t=document.querySelector(".hp_banner"),e=t.offsetWidth,n=t.children[0],a=1,i=null,o=0,s=0,l=t.children[1].children;n.insertBefore(n.lastElementChild.cloneNode(!0),n.children[0]),n.appendChild(n.children[1].cloneNode(!0));var r=n.children;n.style.width=100*r.length+"%";for(var c=0;c<r.length;c++)r[c].style.width=100/r.length+"%";var m=function(){n.style.transition="none",n.style.webkitTransition="none"},h=function(){n.style.transition="all .3s",n.style.webkitTransition="all .3s"},u=function(t){n.style.transform="translateX("+t+"px)",n.style.transform="webkitTranslateX("+t+"px)"},d=function(t){var e=document.querySelector(".hp_banner ol li.active");e.classList.remove("active"),l[t].classList.add("active")};u(-a*e);var f=function(){a++,h(),u(-a*e)};i=setInterval(f,2e3),n.addEventListener("touchstart",function(t){clearInterval(i),m(),o=t.touches[0].clientX}),n.addEventListener("touchmove",function(t){console.log("aa"),s=t.touches[0].clientX-o,u(-a*e+s)}),n.addEventListener("touchend",function(){Math.abs(s)>e/3&&(s<0?a++:a--,s=0),h(),u(-a*e),i=setInterval(f,2e3),console.log(a)}),n.addEventListener("transitionEnd",function(){a>=n.children.length-1?(a=1,m(),u(-a*e)):a<=0&&(a=n.children.length-2,m(),u(-a*e)),d(a-1)}),n.addEventListener("webkitTransitionEnd",function(){a>=n.children.length-1?(a=1,m(),u(-a*e)):a<=0&&(a=n.children.length-2,m(),u(-a*e)),d(a-1)}),window.onblur=function(){clearInterval(i)},window.onfocus=function(){i=setInterval(f,2e3)},window.onresize=function(){e=t.offsetWidth,u(-a*e)}}function tabTemplate(t){$(".hp_main_content").addClass("loading"),$.getJSON("http://czdm.ittun.com/api/gethometab/"+t,null,function(e){var n=template("tab",{items:e}),a=$("#hp_content"+t+" ul");a.html(n),$(".hp_main_content").removeClass("loading")})}function lianzaiTemplate(){$.getJSON("http://czdm.ittun.com/api/getlianzai",null,function(t){var e=template("lianzai",{items:t});$(".serialize_content ul").html(e),setTimeout(function(){var t=$(".serialize_content ul li").height();$(".serialize_content ul li p").css({height:t/4+"px",lineHeight:t/4+"px"})},40)})}function listTemplate(){$.getJSON("http://czdm.ittun.com/api/gettopics",null,function(t){var e=template("list",{items:t});$(".topics_content ul").html(e)})}$(function(){}),window.onload=function(){function t(){$("#homePage_mask").removeClass("active"),$(".nav").css({transform:"translateX(-100%)",webkitTransform:"translateX(-100%)"}),o=.6*-l,$(".homePage").hide().css({transform:"none",webkitTransform:"none"}),i=0}function e(t,e,n){var a=.6*l,s=0,r=0,c=-a,m=0,h=!1,u=!1,d=0;i=0,o=-a;var f=function(t,a){e.style.transform="translateX("+t+"px)",n.style.transform="translateX("+a+"px)",e.style.transform="webkitTranslateX("+t+"px)",n.style.transform="webkitTranslateX("+a+"px)"},p=function(){e.style.transition="none",n.style.transition="none",e.style.webkitTransition="none",n.style.webkitTransition="none"},v=function(){e.style.transition="all .3s",n.style.transition="all .3s",e.style.webkitTransition="all .3s",n.style.webkitTransition="all .3s"};t.addEventListener("touchstart",function(t){m=t.touches[0].clientX,p(),u=!!$("#homePage_mask").hasClass("active")}),t.addEventListener("touchmove",function(t){d=t.touches[0].clientX-m,(d>150||$("#homePage_mask").hasClass("active"))&&(h=!0),h&&(u||(d-=150),temph=i+d,tempn=o+d,temph>=a?(temph=a,tempn=r):temph<=s&&(temph=s,tempn=c),f(temph,tempn))}),t.addEventListener("touchend",function(t){v(),h&&(i+=d,o+=d,i>=a||d>.3*l?(i=a,o=r,$("#homePage_mask").addClass("active")):(i<=s||d<=.3*l)&&(i=s,o=c),f(i,o)),i==s&&$("#homePage_mask").removeClass("active"),h=!1})}lunboTemplate(),tabTemplate(1);var n=document.querySelectorAll(".hp_main_title li a");console.log(n);for(var a=0;a<n.length;a++)itheima.tap(n[a],function(t){if(!$(".hp_main_content").hasClass("loading")){$(".hp_main_title li a.active").removeClass("active"),$(t.target).addClass("active");var e=t.target.dataset.tab,n=e.slice(-1);$(".hp_content.active").removeClass("active"),$(e).addClass("active"),tabTemplate(n)}});var i=0,o=0,s=document.querySelector(".layout"),l=s.offsetWidth,r=document.querySelector(".homePage"),c=document.querySelector(".nav");e(s,r,c),$("#openNav").on("click",function(){$(".nav").css({transform:"none",webkitTransform:"none"}),o=0,$("#homePage_mask").addClass("active"),$(".homePage").css({transform:"translateX(60%)",webkitTransform:"translateX(60%)"}),i=.6*l}),$("#homePage_mask").on("click",function(){$(".nav").css({transform:"translateX(-100%)",webkitTransform:"translateX(-100%)"}),o=.6*-l,$(".homePage").css({transform:"none",webkitTransform:"none"}),i=0,$("#homePage_mask").removeClass("active")}),$("#openLianzai").on("click",function(){lianzaiTemplate(),t(),$(".topics").hide(),$(".serialize").show()}),$("#openList").on("click",function(){listTemplate(),t(),$(".serialize").hide(),$(".topics").show()}),$(".backHome").on("click",function(){$(".serialize").hide(),$(".topics").hide(),$(".homePage").show().css({transform:"none",webkitTransform:"none"}),i=0,$(".serialize_content ul").css({transform:"none"}),$(".topics_content ul").css({transform:"none"})})};